## π“ κ²½μ‚¬ ν•κ°•λ²• μµμ ν™” μ•κ³ λ¦¬μ¦

κ²½μ‚¬ ν•κ°•λ²• μµμ ν™” μ•κ³ λ¦¬μ¦μ λ³€ν•λ“¤λ΅, μ‹ κ²½λ§μ ν•™μµ μ†λ„μ™€ μ„±λ¥μ„ ν–¥μƒ μ‹ν‚¤κΈ° μ„ν•΄ κ³ μ•λμ—λ‹¤.

### β—ΌοΈ Momentum method

**λ¨λ©ν…€μ„ μ‚¬μ©ν•λ” ν™•λ¥ μ  κ²½μ‚¬ ν•κ°•λ²•μ€ κ° λ°λ³µμ—μ„μ μ—…λ°μ΄νΈμΈ $\\Delta w$ μ„ κΈ°μ–µν•κ³ , λ‹¤μ μ—…λ°μ΄νΈλ¥Ό κ·Έλλ””μ–ΈνΈμ™€ μ΄μ „ μ—…λ°μ΄νΈμ μ„ ν• μ΅°ν•©μΌλ΅ κ²°μ •ν•©λ‹λ‹¤.**

**μ΄μ „ λ‹¨κ³„μ—μ„μ μ†λ„(momentum)μ„ μ‚¬μ©ν•΄ λ‹¤μ λ‹¨κ³„μ μ†λ„λ¥Ό κ²°μ •ν•λ©΄μ„ μµμ ν™”λ¥Ό μν–‰ν•λ” κ²ƒμ…λ‹λ‹¤.**

$$  
\\begin{align}  
\\Delta \\textbf{w}^{r+1} &= \\alpha \\Delta \\textbf{w}^r - \\eta \\nabla E\_i ( \\textbf{w}^r)  
\\\\ \\textbf{w}^{r+1} &= \\textbf{w}^r + \\Delta\\textbf{w}^{r+1}  
\\\\ &= \\textbf{w}^r - \\eta \\nabla E\_i(\\textbf{w}^r) + \\alpha \\Delta \\textbf{w}^r  
\\end{align}  
$$

$\\alpha$κ°’μ€ 0~1 μ‚¬μ΄μ μ§€μμ  κ°μ† κ³„μλ΅, ν„μ¬ κ·Έλλ””μ–ΈνΈμ™€ μ΄μ „ κ·Έλλ””μ–ΈνΈκ°€ κ°€μ¤‘μΉ λ³€κ²½μ— μ–Όλ§λ‚ κΈ°μ—¬ν•λ”μ§€λ¥Ό κ²°μ •ν•©λ‹λ‹¤.

μ΄λ¬ν• μ ‘κ·Όμ€ κ²½μ‚¬ ν•κ°•λ²•μ—μ„μ μ§„λ™κ³Ό μλ ΄μ λ¬Έμ λ¥Ό μ™„ν™”ν•κ³  λΉ λ¥΄κ² μλ ΄ν•  μ μλ„λ΅ λ„μ™€μ¤λ‹λ‹¤.

### β—ΌοΈ AdaGrab(Adaptive Gradient)

AdaGrabμ€ κ° time step $r$μ—μ„ λ¨λ“  νλΌλ―Έν„° $w\_i$μ— λ€ν•΄ λ‹¤λ¥Έ ν•™μµλ¥ μ„ μ‚¬μ©ν•©λ‹λ‹¤.

**λ§μ΄ λ³€ν•μ§€ μ•λ” νλΌλ―Έν„°λ” ν° ν•™μµλ¥ μ„, μμ£Ό λ³€ν•λ” νλΌλ―Έν„°λ” μ‘μ€ ν•™μµλ¥ μ„ κ°–κ² λ©λ‹λ‹¤. κ°κ°μ λ§¤κ°λ³€μμ— λ§μ¶°μ„ ν•™μµλ¥ μ„ λ³€ν™”μ‹ν‚¤κ³ , ν•™μµλ¥ μ„ μ μ°¨ μ¤„μ—¬κ°€λ” λ°©λ²•μ΄λ‹¤.**

μ•„λ μ‹μ—μ„ $G^r = \\sum\_{t=1}^r \\text{diag} ((\\textbf{g}^t)(\\textbf{g}^t)^T) \\in R^{d\\times d}$μ΄κ³  μ΄λ” κ° λ€κ° μ„±λ¶„ $(i,i)$μ΄ μ‹κ°„ λ‹¨κ³„ $r$κΉμ§€μ $w\_i$μ— λ€ν• κ·Έλλ””μ–ΈνΈμ μ κ³± ν•©μΈ λ€κ° ν–‰λ ¬μ΄λ‹¤.

$\\textbf{g}^t$λ” μ‹κ°„ λ‹¨κ³„ $t$μ—μ„μ κ·Έλ λ””μ–ΈνΈ λ²΅ν„°.(κ° νλΌλ―Έν„°μ— λ€ν• νΈλ―Έλ¶„ κ°’μ„ λ‹΄κ³  μλ” λ²΅ν„°)

$$  
\\textbf{g}^t = \\begin{bmatrix} \\frac{\\partial E}{\\partial w\_1} \\\\ \\frac{\\partial E}{\\partial w\_2} \\\\ \\vdots \\\\ \\frac{\\partial E}{\\partial w\_d} \\end{bmatrix}  
$$

$E$λ” μ†μ‹¤ν•¨μμ΄λ©°, κ° $w\_i$λ” νλΌλ―Έν„° κ°€μ¤‘μΉ μ΄λ“¤μ νΈλ―Έλ¶„ λ²΅ν„°

$$  
G^r = \\sum\_{t=1}^r \\text{diag}((\\textbf{g}^t)(\\textbf{g}^t)^T) =  
\\begin{bmatrix}  
\\sum\_{t=1}^r (\\textbf{g}^t\_1)^2 & 0 & \\cdots & 0 \\\\  
0 & \\sum\_{t=1}^r (\\textbf{g}^t\_2)^2 & \\cdots & 0 \\\\  
\\vdots & \\vdots & \\ddots & \\vdots \\\\  
0 & 0 & \\cdots & \\sum\_{t=1}^r (\\textbf{g}^t\_d)^2  
\\end{bmatrix}  
$$

$\\epsilon$μ€ smooting termμΌλ΅ 0μΌλ΅ λ‚λ μ§€λ” κ±Έ λ°©μ§€ν•λ‹¤.(μΌλ°μ μΌλ΅ $10^{-8}$)μ •λ„λ¥Ό μ‚¬μ©.

($\\odot$ : ν–‰λ ¬ μ”μ†λ³„ κ³±μ…)

$$  
\\textbf{w}^{r+1} = \\textbf{w}^r = -\\dfrac{\\eta}{\\sqrt{G^r + \\epsilon}} \\odot \\textbf{g}^r  
$$

**λ¬Έμ λ” μ κ³± κ·Έλλ””μ–ΈνΈμ ν•©($G^r$)μ΄ μ‹κ°„μ— λ”°λΌ κ³„μ†ν•΄μ„ λ„μ λκΈ° λ•λ¬Έμ— ν•™μµλ¥ μ΄ λ„λ¬΄ μ‘μ•„μ§€κ² λκ³ , κ²°κµ­ κ°€μ¤‘μΉμ μ—…λ°μ΄νΈκ°€ κ±°μ μ΄λ£¨μ–΄μ§€μ§€ μ•λ” λ‹¨κ³„κ°€ μƒκΉ€.**

### β—ΌοΈ RMSProp(Root mean square propagation)

RMSPropλ” Adagrabμ κ·Ήμ‹¬ν• ν•™μµλ¥  κ°μ†λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄ κ°λ°λμ—λ‹¤.

ν•™μµλ¥ μ„ κ° λ§¤κ°λ³€μμ— λ€ν•΄ μ μ‘μ μΌλ΅ μ΅°μ ν•λ” λ°©μ‹μ΄λ‹¤. κ° λ§¤κ°λ³€μλ§λ‹¤ λ‹¤λ¥Έ ν•™μµλ¥ μ„ μ‚¬μ©ν•μ—¬ ν¨μ¨μ μΌλ΅ ν•™μµν•λ‹¤.

**Adagrabκ³Ό λ‹¤λ¥΄κ² μ§€μ κ°€μ¤‘ μ΄λ™ ν‰κ· (Exponential moving Average)μ„ μ‚¬μ©ν•μ—¬ κ³Όκ±°μ μ κ³±λ κ·Έλλ””μ–ΈνΈ κ°’μ„ μ¶”μ ν•λ‹¤. μµκ·Ό κ·Έλ λ””μ–ΈνΈ μ •λ³΄μ— λ” λ†’μ€ κ°€μ¤‘μΉλ¥Ό λ¶€μ—¬ν•λ©΄μ„ κ·Έλλ””μ–ΈνΈ λ³€ν™”λ¥Ό μ¶”μ ν•λ”λ° λ„μ›€μ΄ λλ‹¤.**

$$  
\\begin{align}  
E\[g^2\]^r &= \\gamma E\[g^2\]^{r-1} + (1-\\gamma)\[g^2\]^r  
\\\\ &= \\textbf{w}^{r+1} = \\textbf{w}^r - \\dfrac{\\eta}{\\sqrt{E\[g^r\]^r +\\epsilon}} \\textbf{g}^r  
\\end{align}  
$$

μ΄λ ‡κ² κ° κ°€μ¤‘μΉμ— λ€ν• μ κ³± κ·Έλλ””μ–ΈνΈμ μ§€μμ μΌλ΅ κ°μ†ν•λ” ν‰κ· μΌλ΅ ν•™μµλ¥ μ„ λ‚λ”λ‹¤.

### β—ΌοΈ Adam(Adaptive momentum)

μ μ‘μ  λ¨λ©ν…€ μ¶”μ •μ€ κ° λ§¤κ°λ³€μμ— λ€ν• μ μ‘μ  ν•™μµλ¥ μ„ κ³„μ‚°ν•λ” λ λ‹¤λ¥Έ λ°©λ²•μ΄λ‹¤. RMSPropκ³Ό κ°™μ΄ μ§€μμ μΌλ΅ κ°μ†ν•λ” **κ³Όκ±° μ κ³± κ·Έλλ””μ–ΈνΈμ ν‰κ·  $v^r$**μ„ μ €μ¥ν•λ” κ²ƒ μ™Έμ—λ„, Adamμ€ λ¨λ©ν…€κ³Ό μ μ‚¬ν•κ² **κ³Όκ±° κ·Έλλ””μ–ΈνΈμ μ§€μμ μΌλ΅ κ°μ†ν•λ” ν‰κ·  $\\textbf{m}^r$**λ„ μ μ§€ν•λ‹¤.

RMSPropκ³Ό λΉ„μ·ν•κ² κ° λ§¤κ°λ³€μμ— λ€ν• μ κ³± κ·Έλλ””μ–ΈνΈμ μ§€μμ μΌλ΅ κ°μ†ν•λ” ν‰κ· μ„ κ³„μ‚°ν•μ—¬ κ°€μ¤‘μΉ μ—…λ°μ΄νΈμ— μ‚¬μ©ν•κ³ ,

λ¨λ©ν…€κ³Ό λΉ„μ·ν•κ², κ³Όκ±°μ κ·Έλλ””μ–ΈνΈμ μ§€μμ μΌλ΅ κ°μ†ν•λ” ν‰κ·  $\\textbf{m}^r$λ„ μ μ§€ν•λ‹¤λ” κ²ƒ.

$$  
\\begin{align}  
\\textbf{m}^r &= \\beta\_1 \\textbf{m}^{r-1} + (1-\\beta\_1)\\textbf{g}^r  
\\\\ v^r &= \\beta\_2 v^{r-1} + (1-\\beta\_2)(g^2)^r  
\\end{align}  
$$

**$\\textbf{m}^r, v^r$μ΄ 0μΌλ΅ μ΄κΈ°ν™”λ λ²΅ν„°λ΅ μ‹μ‘ν•κΈ° λ•λ¬Έμ— μ΄κΈ° λ‹¨κ³„μ—μ„(κ°μ‡ μ¨μ΄ μ‘μ„ λ•) μ΄ λ“¤μ΄ νΈν–¥ λμ–΄μλ‹¤. κ·Έλμ„ νΈν–¥μ„ μƒμ‡„ν•κΈ° μ„ν•΄ νΈν–¥ λ³΄μ •λ μ²«, λ‘ λ²μ§Έ λ¨λ©νΈ μ¶”μ •κ°’μ„ κ³„μ‚°ν•μ—¬ μ‚¬μ©ν•λ‹¤.**

$$  
\\begin{align}  
\\hat{\\textbf{m}}^r &= \\dfrac{\\textbf{m}^r}{1-\\beta\_1^r}  
\\\\ \\hat{v}^r &= \\dfrac{v^r}{1-\\beta\_2^r}  
\\end{align}  
$$

λ‹¤μ μ΄λ¬ν• κ°’μ„ μ‚¬μ©ν•΄μ„ λ§¤κ°λ³€μλ¥Ό μ—…λ°μ΄νΈν•λ©°, Adam update ruleμ„ μƒμ„±

$$  
\\textbf{w}^{r+1} = \\textbf{w}^r - \\dfrac{\\eta}{\\sqrt{\\hat{v}^r + \\epsilon}} \\hat{\\textbf{m}^r}  
$$
